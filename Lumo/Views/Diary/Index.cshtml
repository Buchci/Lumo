@model List<Lumo.Models.DiaryEntry>

@{
    ViewData["Title"] = "Diary";
}

<link rel="stylesheet" href="https://uicdn.toast.com/tui-calendar/latest/tui-calendar.css" />

<div class="container mt-5">
    <!-- Add New Entry Form -->
    <div class="text-left mb-4">
        <button id="toggleEntryForm" class="btn btn-primary">Add New Entry</button>
    </div>
    <div class="card shadow-sm mb-5" id="createEntryCard" style="display: none;">

        <div class="card shadow-sm mb-5">
        <div class="card-body">
            <form id="createEntryForm">
                <div class="mb-3">
                    <label for="title" class="form-label">Title</label>
                    <input type="text" class="form-control" id="title" placeholder="Entry title..." required>
                </div>
                <div class="mb-3">
                    <label for="content" class="form-label">Content</label>
                    <textarea class="form-control" id="content" rows="4" placeholder="Write your thoughts..." required></textarea>
                </div>

                <div class="mb-3">
                    <label class="form-label">Tags</label>
                    <div id="tags" class="d-flex flex-wrap gap-2"></div>
                </div>

                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="entryDate" class="form-label">Date</label>
                        <input type="date" class="form-control" id="entryDate" value="@DateTime.Now.ToString("yyyy-MM-dd")">
                    </div>
                    <div class="col-md-6">
                        <label for="moodRating" class="form-label">Mood</label>
                        <select class="form-select" id="moodRating">
                            <option value="1">😢 Very Bad</option>
                            <option value="2">☹️ Bad</option>
                            <option value="3" selected>😐 Neutral</option>
                            <option value="4">🙂 Good</option>
                            <option value="5">😄 Excellent</option>
                        </select>
                    </div>
                </div>
                <div class="mb-3 form-check">
                    <input type="checkbox" class="form-check-input" id="isFavorite">
                    <label class="form-check-label" for="isFavorite">Favorite ⭐</label>
                </div>
                <button type="submit" class="btn btn-success w-100">Add Entry</button>
            </form>
        </div>
    </div>
    </div>

    <h3 class="mb-3">Diary Calendar</h3>

    <!-- Month Navigation -->
    <div class="d-flex justify-content-between align-items-center mb-2">
        <div>
            <button id="prevMonth" class="btn btn-outline-primary">&lt; Prev</button>
            <button id="nextMonth" class="btn btn-outline-primary ms-2">Next &gt;</button>
            <button id="today" class="btn btn-outline-secondary ms-2">Today</button>
        </div>
        <h4 id="currentMonth" class="mb-0"></h4>
    </div>

    <div id="tui-calendar" style="height: 700px; border: 1px solid #ccc; border-radius: 8px;"></div>
</div>

<!-- Custom Modal for Entry Details -->
@await Html.PartialAsync("_EntryModal")

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://uicdn.toast.com/tui.code-snippet/latest/tui-code-snippet.min.js"></script>
<script src="https://uicdn.toast.com/tui.time-picker/latest/tui-time-picker.min.js"></script>
<script src="https://uicdn.toast.com/tui.date-picker/latest/tui-date-picker.min.js"></script>
<script src="https://uicdn.toast.com/tui-calendar/latest/tui-calendar.min.js"></script>
<script src="~/js/Diary/Index.js"></script>

<style>
.tui-full-calendar-container {
    background: white;
    border-radius: 8px;
}
.tui-full-calendar-schedule {
    border-radius: 6px;
    padding: 3px 5px;
    font-size: 0.9rem;
}

/* Responsive modal for long content and tags */
#entryModal .modal-dialog {
    max-width: 700px;
}
#entryModalTitle {
    padding-left:15px;
    padding-right:15px;
    padding-top:5px;
}
#entryModalBtnClose {
    margin:10px;
}

#entryModal .modal-content {
    display: flex;
    flex-direction: column;
            padding-left: 15px;
            padding-right: 15px;
}

#entryModal .modal-body {
    overflow: visible;
    word-break: break-word;
    max-height: 50vh;
    overflow-y: auto;
}

#entryModalTitle {
    word-break: break-word;
}
    .tui-full-calendar-weekday-schedule {
        min-height: 48px !important;
        padding: 6px !important;
        display:flex;
        align-items: flex-start !important;
        line-height:35px !important;
        border-left: 5px solid;
    }

    .tui-full-calendar-weekday-schedule-title {
        font-size: 14px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

</style>
